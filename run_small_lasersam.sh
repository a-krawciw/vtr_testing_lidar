#!/usr/bin/env bash

source /opt/ros/humble/setup.bash
source $VTRSRC/main/install/setup.bash
source $VTRROOT/vtr_testing_lidar/install/setup.bash


graph_dir=$VTRROOT/laser_vision/graphs
model_dir=$VTRROOT/laser_vision/checkpoints

#data splits


mars_vids="['4294967311', '4294967665', '8589935218', '8589934607', '8589934721', '4294967829', '8589935116', '4294967625', '4294967796', '4294967850', '8589935060', '4294967700', '8589934845', '8589934691', '8589934830', '8589935192', '4294967610', '4294967431', '8589934896', '8589935054', '8589934630', '8589935261', '4294967799', '8589935042', '4294967457', '4294967831', '8589935240', '8589935004', '8589934824', '4294967896', '4294967852', '4294967407', '8589934803', '4294967656', '4294967785', '8589934984', '8589934911', '8589935247', '4294967956', '4294967947', '4294967903', '4294967332', '8589934756', '4294967783', '8589934994', '4294967752', '4294967576', '4294967746', '8589934857', '4294967475']"

mars_tids="['14', '365', '619', '14', '123', '528', '519', '325', '496', '550', '464', '402', '244', '92', '229', '594', '311', '128', '295', '457', '34', '659', '499', '445', '154', '530', '642', '405', '223', '593', '551', '103', '203', '355', '485', '384', '312', '649', '652', '645', '602', '35', '157', '483', '400', '452', '274', '446', '256', '174']"



long_loop_vids="['8589934763', '8589935010', '8589934655', '4294967668', '4294967812', '8589934851', '4294967971', '4294967583', '8589934878', '4294967922', '4294967360', '4294967586', '4294967758', '8589935218', '4294967762', '8589934816', '4294967611', '8589934598', '8589934729', '8589934985', '4294967579', '8589935126', '8589935266', '4294967696', '4294967693', '8589934653', '4294967492', '4294967950', '4294967444', '4294967545', '4294967646', '4294967712', '4294967650', '4294967851', '8589935090', '4294967761', '8589934808', '4294967722', '8589935261', '8589935078', '4294967846', '8589934738', '4294967843', '4294967496', '4294967665', '8589934893', '8589934920', '4294967568', '4294967333', '8589935076']"

frame_17_vid="['4294967758']"
frame_17_tid="['457']"

long_loop_tids="['171', '418', '64', '365', '511', '263', '672', '289', '292', '624', '65', '292', '457', '629', '464', '230', '313', '7', '135', '394', '285', '533', '679', '396', '394', '62', '208', '653', '146', '252', '347', '408', '349', '549', '501', '462', '202', '423', '673', '489', '545', '144', '542', '214', '364', '307', '333', '274', '38', '487']"

long_loop_times="[1713889286534971392, 1713889393379118336, 1713889244155089664, 1713889005678430464, 1713889082837095424, 1713889320318019584, 1713889153501982720, 1713888950105836544, 1713889337309190400, 1713889128514776320, 1713888846758819072, 1713888951305216768, 1713889051653607424, 1713889476437383424, 1713889053252328960, 1713889306624532480, 1713888962499032320, 1713889222066644224, 1713889272841102336, 1713889383284560896, 1713888948206444800, 1713889438956367360, 1713889496327040768, 1713889016672343040, 1713889015573312256, 1713889243356122368, 1713888904527358976, 1713889144606614528, 1713888882939760128, 1713888934913406976, 1713888994184265728, 1713889031264382720, 1713888996083003136, 1713889098629462784, 1713889425063187968, 1713889052853017600, 1713889303626532608, 1713889036261360640, 1713889494128255488, 1713889420465242368, 1713889096730471936, 1713889276239800576, 1713889095531390720, 1713888906226839296, 1713889003978602240, 1713889343605765888, 1713889355298999040, 1713888943908520192, 1713888835964290304, 1713889419665555712]"
mars_times="[1713887496549180416, 1713887641174851584, 1713887410193292032, 1713887152226778624, 1713887198203126528, 1713887706141657600, 1713887369414473472, 1713887625681566720, 1713887693348019968, 1713887714637636352, 1713887340430383872, 1713887655467743232, 1713887246977327104, 1713887185710247168, 1713887241180337920, 1713887399999353600, 1713887619884576256, 1713887548721747712, 1713887266567160832, 1713887338131307264, 1713887161521975808, 1713887430283398656, 1713887694447654400, 1713887333134464512, 1713887558916843264, 1713887706941565952, 1713887419188759040, 1713887318041902336, 1713887238881814272, 1713887732727964160, 1713887715437288960, 1713887539326597888, 1713887230786525696, 1713887637576600832, 1713887689150482688, 1713887302249883904, 1713887272663869184, 1713887422687194368, 1713887756916037888, 1713887753317696256, 1713887735626760448, 1713887507043295232, 1713887211996611840, 1713887688350903552, 1713887314043959040, 1713887676256798976, 1713887606392123136, 1713887673858343936, 1713887251374940160, 1713887566213048064]"

trap exit SIGINT



#ros2 run vtr_test_lidar vtr_test_lidar_lasersam --ros-args --params-file $VTRROOT/vtr_testing_lidar/src/vtr_test_lidar/config/ouster_lasersam_short_test.yaml \
#	-p data_dir:=$graph_dir \
#	-p model_dir:=$VTRMODELS \
#	-p name:=MarsDay2 \
#	-p vertices_in_use:="$mars_vids" \
#	-p teach_vs_in_use:="$mars_tids"



#ros2 run vtr_test_lidar vtr_test_lidar_lasersam --ros-args --params-file $VTRROOT/vtr_testing_lidar/src/vtr_test_lidar/config/ouster_lasersam_short_test.yaml \
#	-p sequence_dir:=$VTRDATA/ouster_dataset/LongLoop2 \
#	-p data_dir:=$graph_dir \
#	-p model_dir:=$VTRMODELS \
#	-p name:=LongLoop2 \
#	-p vertices_in_use:="$long_loop_vids" \
#	-p teach_vs_in_use:="$long_loop_tids"
#

ros2 run vtr_test_lidar vtr_test_lidar_lasersam --ros-args --params-file $VTRROOT/vtr_testing_lidar/src/vtr_test_lidar/config/ouster_lasersam_short_test.yaml \
	-p sequence_dir:=$VTRDATA/ouster_dataset/LongLoop2 \
	-p data_dir:=$graph_dir \
	-p model_dir:=$VTRMODELS \
	-p name:=LongLoop2 \
	-p vertices_in_use:="$frame_17_vid" \
	-p teach_vs_in_use:="$frame_17_tid"


